(function(b){var a=new Class({$events:null,init:function(){this.$events={};},on:function(c,d){this.$events[c]=this.$events[c]||[];this.$events[c].push(d);},fire:function(c,g){var f=this.$events[c];if(f){for(var d in f){var e=f[d];e.apply(this,[g]);}}},detach:function(c,f){var e=this.$events[c];for(var d=0;d<e.length;d++){if(e[d]==f){delete e[d];return;}}return;}});b.EventManager=a;}(GA));(function(b){var a=b.EventManager.extend({init:function(){this._parent();},onMessage:function(d,c){b.dispatcher.on(d,b.bind(c,this));},sendMessage:function(d,c){b.dispatcher.fire(d,c);}});b.MsgManager=a;b.dispatcher=new a();}(GA));(function(d){var a=null;var c=".page";var b=d.EventManager.extend({tableName:"",filters:[],rowCount:20,cluster:null,showLoading:false,tables:[],init:function(e){if(a){throw new Error("You can only create one instance of DataManager!");}this._parent();}});b.getInstance=function(){if(a){return a;}a=new b();return a;};d.DataManager=b;}(GA));(function(b){var a=b.MsgManager.extend({app:null,mustache:null,templates:null,init:function(c){this.mustache=b.mustache;this.templates=c.templates;this.container=c.container;this.hideOnStates=c.hideOnStates||[];this.formatRenderData=c.formatRenderData;this.dataManager=b.DataManager.getInstance();this.events=b.extend(this.events||{},c.events||{});this.parseEvents();this.register();},register:function(){},render:function(){},parseEvents:function(){var e=this.events||{};for(var c in e){for(var d in e[c]){var f=this[e[c][d]]||e[c][d];b.delegate(this.container,c,d,b.bind(f,this));}}},getDictionary:function(){return b.LanguageManager.getInstance().dictionary;}});b.View=a;}(GA));(function(b){var a=b.View.extend({map:null,events:{},init:function(c){this._parent(c);this.markerInfo=c.markerInfo||{url:"images/orange-pin.png",position:{lat:45.757284,lng:21.228633}};this.radius=c.radius||1000;this.zoom=c.zoom||15;},register:function(){this.onMessage("showView",this.onShowView);},render:function(){var c={zoom:this.zoom,center:new google.maps.LatLng(this.markerInfo.position.lat,this.markerInfo.position.lng),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT,position:google.maps.ControlPosition.TOP_RIGHT},panControl:true,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},};this.map=new google.maps.Map(this.container,c);return this;},drawMarker:function(){if(!this.markerInfo){return;}this.marker=new google.maps.Marker({map:this.map,animation:google.maps.Animation.DROP,draggable:true,icon:this.markerInfo.url,position:new google.maps.LatLng(this.markerInfo.position.lat,this.markerInfo.position.lng)});this.drawCoverage();this.marker.adCoverage=this.adCoverage;this.adCoverage.bindTo("map",this.marker);this.adCoverage.bindTo("center",this.marker,"position");google.maps.event.addListener(this.marker,"dragend",b.bind(function(){this.drawCoverage();},this));},drawCoverage:function(){var c=this.marker.getPosition();if(!this.adCoverage){this.adCoverage=new google.maps.Circle({editable:true,center:c,radius:this.radius,strokeColor:"#008CE4",strokeOpacity:0.5,strokeWeight:1,fillColor:"#00A4E4",fillOpacity:0.3});}else{this.adCoverage.setCenter(c);}this.adCoverage.setMap(this.map);},drawRegion:function(e){var d=new google.maps.LatLng(46.16,24.13);var c=150000;this.transylvaniaRegion=new google.maps.Circle({center:d,radius:c,strokeColor:"#81B23C",strokeOpacity:0.8,strokeWeight:2,fillColor:"#81B23C",fillOpacity:0.2});this.transylvaniaRegion.setMap(this.map);google.maps.event.addListener(this.transylvaniaRegion,"mouseover",b.bind(function(){this.transylvaniaRegion.strokeWeight=5;this.transylvaniaRegion.setMap(this.map);},this));google.maps.event.addListener(this.transylvaniaRegion,"mouseout",b.bind(function(){this.transylvaniaRegion.strokeWeight=2;this.transylvaniaRegion.setMap(this.map);},this));},onShowView:function(c){if(c.id!=this.container.id){return;}this.drawMarker();}});b.MapView=a;}(GA));(function(b){var a=b.View.extend({events:{".menu-item":{click:"onMenuItemClick"}},init:function(c){this._parent(c);},register:function(){},render:function(){this.container.innerHTML=this.mustache(this.templates.main,{});return this;},onMenuItemClick:function(c){var d=c.currentTarget.id;switch(d){case"home":this.sendMessage("changeState",{state:b.App.States.GALLERY});break;case"map":this.sendMessage("changeState",{state:b.App.States.MAP});break;case"places":this.sendMessage("changeState",{state:b.App.States.PLACES});break;case"tours":this.sendMessage("changeState",{state:b.App.States.TOURS});break;case"contact":this.sendMessage("changeState",{state:b.App.States.CONTACT});break;}}});b.MenuView=a;}(GA));(function(b){var a=b.View.extend({events:{"#next-step":{click:"onNextStepClick"},"#previous-step":{click:"onPreviousStepClick"}},init:function(c){this._parent(c);},register:function(){},render:function(){this.container.innerHTML=this.mustache(this.templates.main,{});return this;},onNextStepClick:function(c){console.log("next");},onPreviousStepClick:function(c){console.log("previous");}});b.StepsView=a;}(GA));(function(b){var a=b.MsgManager.extend({views:[],state:null,lastState:null,init:function(c){this._parent();this.state=c.state;this.language=c.language;this.addViews(c.views||[]);this.appReady=c.appReady;this.register();b.DataManager.getInstance().app=this;},addView:function(c){if(!c){return;}c.app=this;if(this.views.indexOf(c)==-1){this.views.push(c);}},addViews:function(c){for(var d=0;d<c.length;d++){this.addView(c[d]);}},removeView:function(c){},register:function(){this.onMessage("changeState",this.onChangeState);this.onMessage("reverseState",this.onReverseState);},start:function(){if(this.language){b.LanguageManager.getInstance().loadLanguage(this.language,b.bind(function(){this._start();},this));}else{this._start();}},_start:function(){for(var c=0;c<this.views.length;c++){this.views[c].render();}this.changeState(this.state||"home");if(this.appReady){this.appReady.call(this,[]);}},changeState:function(e){if(e==this.state&&this.lastState!=null){return;
}this.lastState=this.state;this.state=e;for(var d=0;d<this.views.length;d++){var c=this.views[d];if(c.hideOnStates.indexOf(this.state)!=-1){this.hideView(c);}else{this.showView(c);}}this.sendMessage("stateChanged",{currentState:this.state,lastState:this.lastState});},hideView:function(c){b.addClass(c.container,"hide-view");this.sendMessage("hideView",c.container);},showView:function(c){b.removeClass(c.container,"hide-view");this.sendMessage("showView",c.container);},onChangeState:function(c){this.changeState(c.state);},onReverseState:function(c){this.changeState(this.lastState);}});b.App=a;b.App.States={};b.App.States.MAP="map";b.App.States.CONTACT="contact";}(GA));